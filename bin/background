#!/usr/bin/env ruby

if background = ENV['BACKGROUND']
  puts background
  exit 0
end

script = case ENV['TERM_PROGRAM']
when "Apple_Terminal"
  'tell front window of application "Terminal" to background color'
when "iTerm.app"
  'tell application "iTerm" to background color of current session of current terminal'
else
  exit 1
end

colors    = `osascript -e #{script.inspect}`
r, g, b   = colors.split(', ').map(&:to_i)
luminance = 0.3*r + 0.59*g + 0.11*b

puts luminance > 65535/2 ? :light : :dark
